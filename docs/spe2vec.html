---

title: SPE2Vec

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks_build/03_spe2vec.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Corpus" class="doc_header"><code>class</code> <code>Corpus</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/spe2vec.py#L10" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Corpus</code>(<strong><code>infile</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>isdir</code></strong>=<em><code>False</code></em>, <strong><code>dropout</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p><em>filename</em>: A file that stores SMILES line-by-line.</p>
<p><em>tokenizer</em>: SPE tokenizer</p>
<p><em>dropout</em>: SPE dropout, default = 0</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="learn_spe2vec" class="doc_header"><code>learn_spe2vec</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/spe2vec.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>learn_spe2vec</code>(<strong><code>corpus</code></strong>, <strong><code>outfile</code></strong>=<em><code>None</code></em>, <strong><code>vector_size</code></strong>=<em><code>100</code></em>, <strong><code>window</code></strong>=<em><code>10</code></em>, <strong><code>min_count</code></strong>=<em><code>10</code></em>, <strong><code>n_jobs</code></strong>=<em><code>1</code></em>, <strong><code>method</code></strong>=<em><code>'skip-gram'</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Train a spe2vec model.</p>
<p><em>corpus</em>: an instance of <code>Class Corpus()</code></p>
<p><em>outfile</em>: str, name of the spe2vec model file.</p>
<p><em>vector_size</em>: dimensions of embedding.</p>
<p><em>window</em>: number of tokens considered as context</p>
<p><em>min_count</em>: number of occurrences a token should have to be considered in training</p>
<p><em>n_jobs</em>: number of cpu cores used for training.</p>
<p><em>method</em>: modeling method, choose from ['cbow', 'skip-gram']</p>
<p>More training parameter can be found <a href="https://radimrehurek.com/gensim/models/word2vec.html#gensim.models.word2vec.Word2Vec">https://radimrehurek.com/gensim/models/word2vec.html#gensim.models.word2vec.Word2Vec</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_spe2vec" class="doc_header"><code>load_spe2vec</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/spe2vec.py#L71" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_spe2vec</code>(<strong><code>model_path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">SPE2Vec</span><span class="p">(</span><span class="s1">&#39;../experiments/results/spe_model.bin&#39;</span><span class="p">,</span> <span class="n">spe</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;c1ccccc1&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">smiles2vec</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="s1">&#39;c1ccccc1[dum]&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;c1ccccc1 [dum]&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">spe2vec</span><span class="p">(</span><span class="s1">&#39;c1ccccc1[dum]&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([ 0.00324177, -0.18124679,  0.1894573 ,  0.29736474, -0.14143717,
        -0.03290153, -0.31891045,  0.16373567, -0.12413523, -0.08658446,
        -0.23956653,  0.05335753,  0.18146366, -0.17212407, -0.17879114,
        -0.01039552, -0.00274071,  0.01653983,  0.08432296, -0.15634526,
         0.29629305, -0.16786121,  0.06479991,  0.34462902, -0.11052489,
        -0.13513446,  0.16418819, -0.21508686, -0.01842665, -0.15818536,
        -0.05421342,  0.2041645 ,  0.14783993, -0.00653112, -0.19034739,
        -0.11876111,  0.12208337, -0.0743893 ,  0.03400969,  0.04422404,
        -0.10224582,  0.34490895,  0.12326851, -0.08695894, -0.08150315,
         0.09907438,  0.28797793,  0.15912676,  0.15228626, -0.164707  ,
         0.33839643, -0.04265443, -0.11858924,  0.10059267, -0.24335982,
        -0.02948368,  0.53029126,  0.2448303 ,  0.11335112,  0.01153868,
        -0.01010862, -0.06406022, -0.01338368, -0.18424016,  0.03580371,
         0.18463984,  0.15326728, -0.15144381, -0.0136445 , -0.01842183,
        -0.01942809, -0.40844846, -0.3803786 ,  0.06027165,  0.1963685 ,
         0.17956594,  0.43164128,  0.15884452, -0.05903239, -0.12084594,
        -0.3421759 ,  0.09406078, -0.1743247 , -0.07216409, -0.36593992,
         0.40148914,  0.06790256,  0.00517231, -0.03673836,  0.15515997,
         0.05461619,  0.34084585,  0.18900603, -0.02054791, -0.3929679 ,
         0.02184797,  0.63548833,  0.15527408, -0.04567065, -0.04842073],
       dtype=float32),
 array([ 0.02790021,  0.10730326,  0.03549408,  0.29470772, -0.12696277,
        -0.17874953, -0.14898987, -0.01619787,  0.05362142,  0.04036978,
         0.01510846, -0.10854848,  0.11008958, -0.19785249,  0.1081469 ,
         0.09286551,  0.02338837,  0.1321442 , -0.05999994, -0.2136096 ,
         0.21495438, -0.01279392,  0.05619901,  0.30066583, -0.11601048,
         0.11202455,  0.09189299, -0.04536214,  0.08480586, -0.12446755,
        -0.15830296,  0.2975169 , -0.00044652, -0.1067949 , -0.13344204,
        -0.22030011,  0.06412205, -0.1179566 ,  0.06744988, -0.04845589,
         0.03443845,  0.0760651 , -0.00702342, -0.15744554, -0.03714913,
        -0.08268054, -0.0328347 ,  0.03743869,  0.09009899, -0.04988885,
         0.11295835, -0.10700615, -0.16241288, -0.13567367,  0.05850025,
        -0.00316843,  0.27738932,  0.00349046, -0.10917356,  0.05029386,
         0.07648825,  0.03960387,  0.033869  , -0.11763074, -0.04516807,
        -0.02431042, -0.03469331, -0.00660511,  0.12014298, -0.19823211,
         0.10597764, -0.12160178, -0.09303743,  0.11049194, -0.04670779,
         0.18275349,  0.14410464,  0.10586358,  0.13328582, -0.10212968,
        -0.06977161,  0.02081367, -0.14675769, -0.23168154, -0.02661432,
         0.12376714,  0.1612328 ,  0.12798673,  0.03350298, -0.02620391,
         0.01916613,  0.06788647, -0.00453908, -0.07472298, -0.19086805,
         0.08175525,  0.13679074,  0.02294019, -0.08880823, -0.11674882],
       dtype=float32)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">spe2vec</span><span class="p">(</span><span class="s1">&#39;c1ccccc1[dum]&#39;</span><span class="p">,</span><span class="n">skip_unknown</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[array([ 0.00324177, -0.18124679,  0.1894573 ,  0.29736474, -0.14143717,
        -0.03290153, -0.31891045,  0.16373567, -0.12413523, -0.08658446,
        -0.23956653,  0.05335753,  0.18146366, -0.17212407, -0.17879114,
        -0.01039552, -0.00274071,  0.01653983,  0.08432296, -0.15634526,
         0.29629305, -0.16786121,  0.06479991,  0.34462902, -0.11052489,
        -0.13513446,  0.16418819, -0.21508686, -0.01842665, -0.15818536,
        -0.05421342,  0.2041645 ,  0.14783993, -0.00653112, -0.19034739,
        -0.11876111,  0.12208337, -0.0743893 ,  0.03400969,  0.04422404,
        -0.10224582,  0.34490895,  0.12326851, -0.08695894, -0.08150315,
         0.09907438,  0.28797793,  0.15912676,  0.15228626, -0.164707  ,
         0.33839643, -0.04265443, -0.11858924,  0.10059267, -0.24335982,
        -0.02948368,  0.53029126,  0.2448303 ,  0.11335112,  0.01153868,
        -0.01010862, -0.06406022, -0.01338368, -0.18424016,  0.03580371,
         0.18463984,  0.15326728, -0.15144381, -0.0136445 , -0.01842183,
        -0.01942809, -0.40844846, -0.3803786 ,  0.06027165,  0.1963685 ,
         0.17956594,  0.43164128,  0.15884452, -0.05903239, -0.12084594,
        -0.3421759 ,  0.09406078, -0.1743247 , -0.07216409, -0.36593992,
         0.40148914,  0.06790256,  0.00517231, -0.03673836,  0.15515997,
         0.05461619,  0.34084585,  0.18900603, -0.02054791, -0.3929679 ,
         0.02184797,  0.63548833,  0.15527408, -0.04567065, -0.04842073],
       dtype=float32)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

