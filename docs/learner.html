---

title: SMILES Pair Encoding (SmilesPE) Learner

keywords: fastai
sidebar: home_sidebar

summary: "Train a SmilesPE learner "
description: "Train a SmilesPE learner "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks_build/01_learner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="atomwise_tokenizer" class="doc_header"><code>atomwise_tokenizer</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>atomwise_tokenizer</code>(<strong><code>smi</code></strong>, <strong><code>exclusive_tokens</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Tokenize a SMILES molecule at atom-level:
    (1) 'Br' and 'Cl' are two-character tokens
    (2) Symbols with bracket are considered as tokens</p>
<p>exclusive_tokens: A list of specifical symbols with bracket you want to keep. e.g., ['[C@@H]', '[nH]'].
Other symbols with bracket will be replaced by '[UNK]'. default is <code>None</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="randomize_smiles" class="doc_header"><code>randomize_smiles</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L38" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>randomize_smiles</code>(<strong><code>smiles</code></strong>)</p>
</blockquote>
<p>Require <code>RDKit</code> library.</p>
<p>Generate a new SMILES string for the same molecule.</p>
<p>Perform a randomization of a SMILES string must be RDKit sanitizable.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_vocabulary" class="doc_header"><code>get_vocabulary</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_vocabulary</code>(<strong><code>smiles</code></strong>, <strong><code>augmentation</code></strong>=<em><code>0</code></em>, <strong><code>exclusive_tokens</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Read text and return dictionary that encodes vocabulary</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="update_pair_statistics" class="doc_header"><code>update_pair_statistics</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>update_pair_statistics</code>(<strong><code>pair</code></strong>, <strong><code>changed</code></strong>, <strong><code>stats</code></strong>, <strong><code>indices</code></strong>)</p>
</blockquote>
<p>Minimally update the indices and frequency of symbol pairs
if we merge a pair of symbols, only pairs that overlap with occurrences
of this pair are affected, and need to be updated.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_pair_statistics" class="doc_header"><code>get_pair_statistics</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_pair_statistics</code>(<strong><code>vocab</code></strong>)</p>
</blockquote>
<p>Count frequency of all symbol pairs, and create index</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="replace_pair" class="doc_header"><code>replace_pair</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L153" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>replace_pair</code>(<strong><code>pair</code></strong>, <strong><code>vocab</code></strong>, <strong><code>indices</code></strong>)</p>
</blockquote>
<p>Replace all occurrences of a symbol pair ('A', 'B') with a new symbol 'AB'</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prune_stats" class="doc_header"><code>prune_stats</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L177" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prune_stats</code>(<strong><code>stats</code></strong>, <strong><code>big_stats</code></strong>, <strong><code>threshold</code></strong>)</p>
</blockquote>
<p>Prune statistics dict for efficiency of max()
The frequency of a symbol pair never increases, so pruning is generally safe
(until we the most frequent pair is less frequent than a pair we previously pruned)
big_stats keeps full statistics for when we need to access pruned items</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="learn_SPE" class="doc_header"><code>learn_SPE</code><a href="https://github.com/XinhaoLi74/SmilesPE/tree/master/SmilesPE/learner.py#L191" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>learn_SPE</code>(<strong><code>infile</code></strong>, <strong><code>outfile</code></strong>, <strong><code>num_symbols</code></strong>, <strong><code>min_frequency</code></strong>=<em><code>2</code></em>, <strong><code>augmentation</code></strong>=<em><code>0</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>, <strong><code>total_symbols</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Learn num_symbols SPE operations from infile and write to outfile.</p>
<p><em>infile</em>: a list of SMILES</p>
<p><em>num_symbols</em>: maximum total number of SPE symbols</p>
<p><em>min_frequency</em>: the minimum frequency of SPE symbols appears.</p>
<p><em>augmentation</em>: times of SMILES augmentation</p>
<p><em>verbose</em>: if True, print the merging process</p>
<p><em>total_symbols</em>: if True; the maximum total of SPE symbols = num_symbols - number of atom-level tokens</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

