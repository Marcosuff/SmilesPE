---

title: SMILES Pair Encoding (SmilesPE).

keywords: fastai
sidebar: home_sidebar

summary: "SMILES Pair Encoding (SmilesPE) trains a substructure tokenizer from a large set of SMILES strings (e.g., ChEMBL) based on [byte-pair-encoding (BPE)](https://www.aclweb.org/anthology/P16-1162/)."
description: "SMILES Pair Encoding (SmilesPE) trains a substructure tokenizer from a large set of SMILES strings (e.g., ChEMBL) based on [byte-pair-encoding (BPE)](https://www.aclweb.org/anthology/P16-1162/)."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks_build/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">Overview<a class="anchor-link" href="#Overview"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install SmilesPE</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Basic-Tokenizers">Basic Tokenizers<a class="anchor-link" href="#Basic-Tokenizers"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Atom-level Tokenizer</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">SmilesPE.pretokenizer</span> <span class="kn">import</span> <span class="n">atomwise_tokenizer</span>

<span class="n">smi</span> <span class="o">=</span> <span class="s1">&#39;CC[N+](C)(C)Cc1ccccc1Br&#39;</span>
<span class="n">toks</span> <span class="o">=</span> <span class="n">atomwise_tokenizer</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;C&#39;, &#39;C&#39;, &#39;[N+]&#39;, &#39;(&#39;, &#39;C&#39;, &#39;)&#39;, &#39;(&#39;, &#39;C&#39;, &#39;)&#39;, &#39;C&#39;, &#39;c&#39;, &#39;1&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;1&#39;, &#39;Br&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>K-mer Tokenzier</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">SmilesPE.pretokenizer</span> <span class="kn">import</span> <span class="n">kmer_tokenizer</span>

<span class="n">smi</span> <span class="o">=</span> <span class="s1">&#39;CC[N+](C)(C)Cc1ccccc1Br&#39;</span>
<span class="n">toks</span> <span class="o">=</span> <span class="n">kmer_tokenizer</span><span class="p">(</span><span class="n">smi</span><span class="p">,</span> <span class="n">ngram</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;CC[N+](&#39;, &#39;C[N+](C&#39;, &#39;[N+](C)&#39;, &#39;(C)(&#39;, &#39;C)(C&#39;, &#39;)(C)&#39;, &#39;(C)C&#39;, &#39;C)Cc&#39;, &#39;)Cc1&#39;, &#39;Cc1c&#39;, &#39;c1cc&#39;, &#39;1ccc&#39;, &#39;cccc&#39;, &#39;cccc&#39;, &#39;ccc1&#39;, &#39;cc1Br&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The basic tokenizers are also compatible with <a href="https://github.com/aspuru-guzik-group/selfies">SELFIES</a> and <a href="https://github.com/baoilleach/deepsmiles">DeepSMILES</a>. Package installations are required.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example of SELFIES</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">selfies</span>
<span class="n">smi</span> <span class="o">=</span> <span class="s1">&#39;CC[N+](C)(C)Cc1ccccc1Br&#39;</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">selfies</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SELFIES string: </span><span class="si">{sel}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SELFIES string: [C][C][N+][Branch1_2][epsilon][C][Branch1_3][epsilon][C][C][c][c][c][c][c][c][Ring1][Branch1_1][Br]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toks</span> <span class="o">=</span> <span class="n">atomwise_tokenizer</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;[C]&#39;, &#39;[C]&#39;, &#39;[N+]&#39;, &#39;[Branch1_2]&#39;, &#39;[epsilon]&#39;, &#39;[C]&#39;, &#39;[Branch1_3]&#39;, &#39;[epsilon]&#39;, &#39;[C]&#39;, &#39;[C]&#39;, &#39;[c]&#39;, &#39;[c]&#39;, &#39;[c]&#39;, &#39;[c]&#39;, &#39;[c]&#39;, &#39;[c]&#39;, &#39;[Ring1]&#39;, &#39;[Branch1_1]&#39;, &#39;[Br]&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toks</span> <span class="o">=</span> <span class="n">kmer_tokenizer</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">ngram</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;[C][C][N+][Branch1_2]&#39;, &#39;[C][N+][Branch1_2][epsilon]&#39;, &#39;[N+][Branch1_2][epsilon][C]&#39;, &#39;[Branch1_2][epsilon][C][Branch1_3]&#39;, &#39;[epsilon][C][Branch1_3][epsilon]&#39;, &#39;[C][Branch1_3][epsilon][C]&#39;, &#39;[Branch1_3][epsilon][C][C]&#39;, &#39;[epsilon][C][C][c]&#39;, &#39;[C][C][c][c]&#39;, &#39;[C][c][c][c]&#39;, &#39;[c][c][c][c]&#39;, &#39;[c][c][c][c]&#39;, &#39;[c][c][c][c]&#39;, &#39;[c][c][c][Ring1]&#39;, &#39;[c][c][Ring1][Branch1_1]&#39;, &#39;[c][Ring1][Branch1_1][Br]&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example of DeepSMILES</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">deepsmiles</span>
<span class="n">converter</span> <span class="o">=</span> <span class="n">deepsmiles</span><span class="o">.</span><span class="n">Converter</span><span class="p">(</span><span class="n">rings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">branches</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">smi</span> <span class="o">=</span> <span class="s1">&#39;CC[N+](C)(C)Cc1ccccc1Br&#39;</span>
<span class="n">deepsmi</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SELFIES string: </span><span class="si">{deepsmi}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SELFIES string: CC[N+]C)C)Ccccccc6Br
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toks</span> <span class="o">=</span> <span class="n">atomwise_tokenizer</span><span class="p">(</span><span class="n">deepsmi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;C&#39;, &#39;C&#39;, &#39;[N+]&#39;, &#39;C&#39;, &#39;)&#39;, &#39;C&#39;, &#39;)&#39;, &#39;C&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;c&#39;, &#39;6&#39;, &#39;Br&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toks</span> <span class="o">=</span> <span class="n">kmer_tokenizer</span><span class="p">(</span><span class="n">deepsmi</span><span class="p">,</span> <span class="n">ngram</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toks</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;CC[N+]C&#39;, &#39;C[N+]C)&#39;, &#39;[N+]C)C&#39;, &#39;C)C)&#39;, &#39;)C)C&#39;, &#39;C)Cc&#39;, &#39;)Ccc&#39;, &#39;Cccc&#39;, &#39;cccc&#39;, &#39;cccc&#39;, &#39;cccc&#39;, &#39;ccc6&#39;, &#39;cc6Br&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Use-the-Pre-trained-SmilesPE-Tokenizer">Use the Pre-trained SmilesPE Tokenizer<a class="anchor-link" href="#Use-the-Pre-trained-SmilesPE-Tokenizer"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train-a-SmilesPE-Tokenizer-with-a-Custom-Dataset">Train a SmilesPE Tokenizer with a Custom Dataset<a class="anchor-link" href="#Train-a-SmilesPE-Tokenizer-with-a-Custom-Dataset"> </a></h3>
</div>
</div>
</div>
    {% endraw %}
</div>
 

